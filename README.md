# CTG_Assg_Group1
### A repository to store files for CTG Assignment
### Obvious warning that implementations of these files should NOT be used in prod

## To install make sure you have the following packages
- hashlib
- re
- sys
- colorama
- secrets
- tinyec

### If you do not have any of these packages, run:
`pip install <package_name>`


## railfenceECCkeygen
### Generates a public-private key pair with help from the tinyec library
```python
import hashlib
import re
import sys
from tinyec import registry
import secrets

text = sys.argv[1]

row_key = int(sys.argv[2])
rail = [["\n" for i in range(len(text))] for j in range(row_key)]

direction_below = False
row, col = 0, 0

for i in range(len(text)):
    if (row == 0) or (row == row_key - 1):
        direction_below = not direction_below

    rail[row][col] = text[i]
    col += 1

    if direction_below:
        row += 1
    else:
        row -= 1

result = []
for i in range(row_key):
    for j in range(len(text)):
        if rail[i][j] != "\n":
            result.append(str(ord(rail[i][j])))

result = int("".join(result))
hashed_result = int(hashlib.sha256(str(result).encode()).hexdigest(), 16)

curve_type = sys.argv[3]

curve = registry.get_curve(curve_type)
random_number = secrets.randbelow(curve.field.n)
point = random_number * curve.g

print("\nCurve equation: ({curve_type})")
print(re.search(r"y\^2 = x\^3[^(]*", str(point)).group(0))

print("\nField size (modulo divisor):")
print(
    re.search(r"\(mod [0-9]+\)", str(point)).group(0).strip("()").removeprefix("mod ")
)

print("\nInitial coordinates:")

print(f"iX: {point.x}")
print(f"iY: {point.y}")

print("\nPrivate key:")
private_key = hashed_result % random_number
print(f"d: {private_key}")

public_point = private_key * point

print("\nPublic coordinates:")
print(f"pX: {public_point.x}")
print(f"pY: {public_point.y}")
```
- Rail fence is used as a diffusion layer, paired with SHA256 to return a hash
- This hash is passed into the key generator (ECC) to be used in the private key / public key points
- An initial point is created based on a random multiplier less than n (private curve multiplier) multiplied by the generator point for the curve
- The private key is generated using the hash modulo the random number
- Public key points are generated by multiplying the initial point with the private key
